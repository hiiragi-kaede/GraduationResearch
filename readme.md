# 概要
卒業研究をするにあたり、6月あたりから勉強していたものをまとめました。
毎日作業していた内容をいきあたりばったりでコミットしているので粒度がバラバラだったり、
ファイル構成やファイル名が適当なものがあるのはごめんなさい。

前半はTSPでの構築法や改善型解法、焼きなましも自作実装とライブラリ使用を試したりしました。

後半はVRPを解くように移行し、最終的にはCVRPを解くようになりました。

# 各フォルダの簡単な説明

* TSP：TSPを解くのに関わるプログラム、及びその出力画像など
* VRP：VRPを解くのに関わるプログラム、及びその出力画像など
* module：Pythonのモジュール分割したファイル置き場
* 考察用：卒論の考察を書く時に使ったプログラムなどの置き場

# 使用したデータについて
[ベンチマークデータ掲載サイト1](http://comopt.ifi.uni-heidelberg.de/software/TSPLIB95/vrp/)

[ベンチマークデータ掲載サイト2](http://vrp.atd-lab.inf.puc-rio.br/index.php/en/)

CVRP用のベンチマークデータがまとめてあるところからダウンロードし、一部情報を改変して利用。
改変後のデータはVRP/CVRP_Dataに格納。

掲載サイト1からダウンロードしたものがVRP/CVRP_Data/tsplibに格納されていて、
掲載サイト2からダウンロードしたもののうち、

VRP/CVRP_Data/vrplibにはUchoa et al. (2014)のデータが、

VRP/CVRP_Data/largeにはArnold, Gendreau and Sörensen (2017)のデータが格納されている。

改変内容としては、各データの上部に記載されている情報のうち、顧客数(Dimension)と容量(Capacity)のみを残して削除している。
今考えるとPythonで読み込んでいるので普通に読み飛ばすように実装すればよかった。
後でダウンロードしたデータでそのまま動くように治すかも。(2022/2/1執筆現在修正なし)

# 実行方法
当初Pythonで実装していたものの、近傍探索は実行速度が重要なのでC++で実装をし直した。

そのため、CVRPを解くプログラムで最新のものはVRP/cpp/main.cppにまとめてある。

## 最初にやること
まず最初に、VRP/cppのディレクトリに移動して

```
mkdir tmp
```

を実行する必要がある。これは.gitignoreでgit上に上げてはいないものの、一時データを置くためのディレクトリとして必須。

## 実行にあたっての注意
解を求めた後、その解の可視化にVRP/cpp/plot.pyを用いているが、
popenを使ってPythonを絶対パスで呼び出させている。

そのため、自分の環境でしか動かないコードになっている。

どこの環境でも動くと思われる修正方法をここに提示しておく。

main.cppをコンパイル実行したあとに、ディレクトリ移動をすることなく

```
python plot.py
tmp/data.txt
tmp/order.txt
```

を入力するようにすればPython,matplotlibが使える環境ならこのようなグラフが表示される。

![img](vrp/cpp/out/sample_out.png)

これはお試しでVRP/CVRP_Data/vrplib/X-n303-k21.txtに対して実行して表示させたもの。

サンプルとして使用するのでトラック番号がきちんと表示されるように調整しているが、デフォルトではtruck~のところは見切れているはず。